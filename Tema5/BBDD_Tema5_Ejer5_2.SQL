CREATE TABLE DEPARTAMENTO(
CLAVE_DEPTO NUMBER(1) CONSTRAINT PK_DEPTO PRIMARY KEY,
NOMBRE VARCHAR(30) NOT NULL,
PRESUPUESTO NUMBER(5) NOT NULL
);

CREATE TABLE EMPLEADOS(
CLAVE_EMPLEADO VARCHAR(5) CONSTRAINT PK_EMPLEADOS PRIMARY KEY,
NOMBRE VARCHAR(30) NOT NULL,
APELLIDOS VARCHAR(30) NOT NULL,
CLAVE_DEPTO NUMBER(1) NOT NULL,
CONSTRAINT FK_DEPTO FOREIGN KEY (CLAVE_DEPTO) REFERENCES DEPARTAMENTO(CLAVE_DEPTO)
);

INSERT INTO DEPARTAMENTO (CLAVE_DEPTO, NOMBRE, PRESUPUESTO) VALUES (1, 'PERSONAL', 80000);
INSERT INTO DEPARTAMENTO (CLAVE_DEPTO, NOMBRE, PRESUPUESTO) VALUES (2, 'ALMACEN', 70000);
INSERT INTO DEPARTAMENTO (CLAVE_DEPTO, NOMBRE, PRESUPUESTO) VALUES (3, 'CONTABILIDAD', 60000);
INSERT INTO DEPARTAMENTO (CLAVE_DEPTO, NOMBRE, PRESUPUESTO) VALUES (4, 'MANUFACTURA', 50000);
INSERT INTO DEPARTAMENTO (CLAVE_DEPTO, NOMBRE, PRESUPUESTO) VALUES (5, 'EMPAQUE', 30000);

INSERT INTO EMPLEADOS (CLAVE_EMPLEADO, NOMBRE, APELLIDOS, CLAVE_DEPTO) VALUES ('EMP01', 'ARMANDO', 'LOPEZ', 2);    
INSERT INTO EMPLEADOS (CLAVE_EMPLEADO, NOMBRE, APELLIDOS, CLAVE_DEPTO) VALUES ('EMP02', 'TATIANA', 'VARGAS', 1);
INSERT INTO EMPLEADOS (CLAVE_EMPLEADO, NOMBRE, APELLIDOS, CLAVE_DEPTO) VALUES ('EMP03', 'LAURA', 'GARCIA', 3);
INSERT INTO EMPLEADOS (CLAVE_EMPLEADO, NOMBRE, APELLIDOS, CLAVE_DEPTO) VALUES ('EMP04', 'JUAN', 'PEREZ', 4);
INSERT INTO EMPLEADOS (CLAVE_EMPLEADO, NOMBRE, APELLIDOS, CLAVE_DEPTO) VALUES ('EMP05', 'IVAN', 'LOPEZ', 4);
INSERT INTO EMPLEADOS (CLAVE_EMPLEADO, NOMBRE, APELLIDOS, CLAVE_DEPTO) VALUES ('EMP06', 'MARGARITA', 'HERNADEZ', 1);
INSERT INTO EMPLEADOS (CLAVE_EMPLEADO, NOMBRE, APELLIDOS, CLAVE_DEPTO) VALUES ('EMP07', 'JESUS', 'PEREZ', 3);
INSERT INTO EMPLEADOS (CLAVE_EMPLEADO, NOMBRE, APELLIDOS, CLAVE_DEPTO) VALUES ('EMP08', 'TOÃ‘O', 'FLORES', 2);
INSERT INTO EMPLEADOS (CLAVE_EMPLEADO, NOMBRE, APELLIDOS, CLAVE_DEPTO) VALUES ('EMP09', 'JUAN', 'LOPEZ', 4);
INSERT INTO EMPLEADOS (CLAVE_EMPLEADO, NOMBRE, APELLIDOS, CLAVE_DEPTO) VALUES ('EMP10', 'JOSE', 'HERNADEZ', 5);

SELECT NOMBRE, APELLIDOS FROM EMPLEADOS;

SELECT DISTINCT APELLIDOS FROM EMPLEADOS ;

SELECT * FROM EMPLEADOS WHERE APELLIDOS = 'LOPEZ';

SELECT EMPLEADOS.NOMBRE, EMPLEADOS.APELLIDOS, DEPARTAMENTO.NOMBRE FROM EMPLEADOS, DEPARTAMENTO WHERE EMPLEADOS.NOMBRE LIKE ('%A')
AND EMPLEADOS.CLAVE_DEPTO = DEPARTAMENTO.CLAVE_DEPTO;

SELECT * FROM EMPLEADOS WHERE APELLIDOS = 'LOPEZ'OR APELLIDOS = 'PEREZ';

SELECT NOMBRE, CLAVE_EMPLEADO FROM EMPLEADOS WHERE CLAVE_DEPTO = 4;

SELECT NOMBRE, APELLIDOS FROM EMPLEADOS WHERE APELLIDOS LIKE 'H%';

SELECT * FROM DEPARTAMENTO WHERE PRESUPUESTO BETWEEN 50000 AND 70000;

SELECT EMPLEADOS.NOMBRE, APELLIDOS, CLAVE_EMPLEADO FROM EMPLEADOS, DEPARTAMENTO WHERE DEPARTAMENTO.NOMBRE = 'CONTABILIDAD' 
AND DEPARTAMENTO.CLAVE_DEPTO = EMPLEADOS.CLAVE_DEPTO;

SELECT EMPLEADOS.NOMBRE, APELLIDOS, DEPARTAMENTO.NOMBRE FROM EMPLEADOS, DEPARTAMENTO WHERE EMPLEADOS.CLAVE_DEPTO = DEPARTAMENTO.CLAVE_DEPTO;

SELECT EMPLEADOS.CLAVE_DEPTO, PRESUPUESTO, COUNT(*), ROUND(PRESUPUESTO/COUNT(*)) FROM DEPARTAMENTO, EMPLEADOS  WHERE EMPLEADOS.CLAVE_DEPTO = departamento.CLAVE_DEPTO
GROUP BY EMPLEADOS.CLAVE_DEPTO, PRESUPUESTO;

SELECT COUNT(*) FROM EMPLEADOS, DEPARTAMENTO WHERE EMPLEADOS.NOMBRE LIKE 'J%' AND DEPARTAMENTO.CLAVE_DEPTO = EMPLEADOS.CLAVE_DEPTO
AND DEPARTAMENTO.NOMBRE = 'MANUFACTURA';